var bt=Object.defineProperty;var ht=(e,t,a)=>t in e?bt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var Ae=(e,t,a)=>(ht(e,typeof t!="symbol"?t+"":t,a),a);import{S as oe,i as le,s as se,a as ue,b as B,f as x,z as _e,n as Y,I as v,J as M,K as ae,d as F,e as w,L as j,c as E,j as J,v as Z,t as q,h as z,M as K,k as g,N as H,O as re,P as Se,B as Ie,o as we,A as Me,Q as Ce,l as _t,p as de,q as X,w as ce,x as me,y as ke,r as ge,u as et,R as wt,G as vt,T as yt}from"./index3.js";import"./httpClient.js";import{g as Ne,i as St,f as kt,a as $t,t as Ct,m as L,n as Te,b as be,c as Tt,M as It,d as Mt,e as At,h as Nt,j as Pt,k as Et,l as Bt,o as Rt}from"./MastodonModal.js";import{c as ve}from"./_commonjsHelpers.js";import"./ed2curve.js";const tt={Asia:["Afghanistan","Armenia","Azerbaijan","Bahrain","Bangladesh","Bhutan","Brunei Darussalam","Cambodia","China","Georgia","Hong Kong","India","Indonesia","Iran (Islamic Republic of)","Iraq","Israel","Japan","Jordan","Kazakhstan","Kuwait","Kyrgyzstan","Lao People's Democratic Republic","Lebanon","Macao","Malaysia","Maldives","Mongolia","Myanmar","Nepal","Korea (Democratic People's Republic of)","Oman","Pakistan","Palestine, State of","Philippines","Qatar","Saudi Arabia","Singapore","Korea (Republic of)","Sri Lanka","Syrian Arab Republic","Taiwan","Tajikistan","Thailand","Timor-Leste","Turkey","Turkmenistan","United Arab Emirates","Uzbekistan","Vietnam","Yemen"],Europe:["\xC5land Islands","Albania","Andorra","Austria","Belarus","Belgium","Bosnia and Herzegovina","Bulgaria","Croatia","Cyprus","Czech Republic","Denmark","Estonia","Faroe Islands","Finland","France","Germany","Gibraltar","Greece","Guernsey","Vatican City","Hungary","Iceland","Ireland","Isle of Man","Italy","Jersey","Latvia","Liechtenstein","Lithuania","Luxembourg","North Macedonia","Malta","Moldova (Republic of)","Monaco","Montenegro","Netherlands","Norway","Poland","Portugal","Republic of Kosovo","Romania","Russian Federation","San Marino","Serbia","Slovakia","Slovenia","Spain","Svalbard and Jan Mayen","Sweden","Switzerland","Ukraine","United Kingdom of Great Britain and Northern Ireland"],Africa:["Algeria","Angola","Benin","Botswana","British Indian Ocean Territory","Burkina Faso","Burundi","Cameroon","Cabo Verde","Central African Republic","Chad","Comoros","Congo","Congo (Democratic Republic of the)","Djibouti","Egypt","Equatorial Guinea","Eritrea","Ethiopia","French Southern Territories","Gabon","Gambia","Ghana","Guinea","Guinea-Bissau","Ivory Coast","Kenya","Lesotho","Liberia","Libya","Madagascar","Malawi","Mali","Mauritania","Mauritius","Mayotte","Morocco","Mozambique","Namibia","Niger","Nigeria","R\xE9union","Rwanda","Saint Helena, Ascension and Tristan da Cunha","Sao Tome and Principe","Senegal","Seychelles","Sierra Leone","Somalia","South Africa","Sudan","South Sudan","Swaziland","Tanzania, United Republic of","Togo","Tunisia","Uganda","Western Sahara","Zambia","Zimbabwe"],Oceania:["American Samoa","Australia","Christmas Island","Cocos (Keeling) Islands","Cook Islands","Fiji","French Polynesia","Guam","Kiribati","Marshall Islands","Micronesia (Federated States of)","Nauru","New Caledonia","New Zealand","Niue","Norfolk Island","Northern Mariana Islands","Palau","Papua New Guinea","Pitcairn","Samoa","Solomon Islands","Tokelau","Tonga","Tuvalu","Vanuatu","Wallis and Futuna"],Americas:["Anguilla","Antigua and Barbuda","Argentina","Aruba","Bahamas","Barbados","Belize","Bermuda","Bolivia (Plurinational State of)","Bonaire, Sint Eustatius and Saba","Brazil","United States Minor Outlying Islands","Virgin Islands (British)","Virgin Islands (U.S.)","Canada","Cayman Islands","Chile","Colombia","Costa Rica","Cuba","Cura\xE7ao","Dominica","Dominican Republic","Ecuador","El Salvador","Falkland Islands (Malvinas)","French Guiana","Greenland","Grenada","Guadeloupe","Guatemala","Guyana","Haiti","Honduras","Jamaica","Martinique","Mexico","Montserrat","Nicaragua","Panama","Paraguay","Peru","Puerto Rico","Saint Barth\xE9lemy","Saint Kitts and Nevis","Saint Lucia","Saint Martin (French part)","Saint Pierre and Miquelon","Saint Vincent and the Grenadines","Sint Maarten (Dutch part)","South Georgia and the South Sandwich Islands","Suriname","Trinidad and Tobago","Turks and Caicos Islands","United States of America","Uruguay","Venezuela (Bolivarian Republic of)"]};function Pe(e){let t,a,n,r,i,l,o,m,s,d,c,f,p,$,b,C,I,S,k;return a=new e[2]({props:{label:"Mastodon Instance Name",sublabel:"Instance name is used for managing the deployed instance and to create a subdomain",placeholder:"Instance name is used for managing the deployed instance and to create a subdomain",controller:e[1].get("name")}}),r=new e[2]({props:{label:"Admin Email",placeholder:"Admin Email",controller:e[1].get("admin").get("email")}}),l=new e[3]({props:{label:"Region",controller:e[1].get("region"),options:[{label:"All",value:null},...Object.keys(tt).map(Ot)]}}),s=new e[4]({props:{label:"<strong>Enable<a href='https://library.threefold.me/info/threefold/#/tokens/threefold__threefold_connect' target='_blank' class='ml-1'>ThreeFold Connect</a></strong>",controller:e[1].get("tfConnect")}}),b=new e[4]({props:{label:"<strong><a href='https://library.threefold.me/info/threefold/#/tfgrid/pricing/threefold__certified_farming' target='_blank' class='mr-1'>Certified</a>Hardware</strong>",controller:e[1].get("certified")}}),{c(){t=w("section"),j(a.$$.fragment),n=E(),j(r.$$.fragment),i=E(),j(l.$$.fragment),o=E(),m=w("div"),j(s.$$.fragment),d=E(),c=w("b-tooltip"),f=w("div"),f.innerHTML='<b-icon icon="fa-solid fa-circle-question"></b-icon>',p=E(),$=w("div"),j(b.$$.fragment),C=E(),I=w("b-tooltip"),S=w("div"),S.innerHTML='<b-icon icon="fa-solid fa-circle-question"></b-icon>',J(f,"margin-top","6px"),Z(c,"tooltip","Users of your instance will be required to log in with ThreeFold Connect to enable another level of security and authenticity."),Z(c,"flow","right"),q(c,"is-hidden-touch",!0),q(c,"is-block",!0),q(c,"mb-2",!0),z(m,"class","is-flex"),J(S,"margin-top","6px"),Z(I,"tooltip","Deploy your instance on a Certified 3Node. Certified 3Nodes come with greater levels of security and performance along with other benefits."),Z(I,"flow","right"),q(I,"is-hidden-touch",!0),z($,"class","is-flex"),J(t,"display",e[0]?"initial":"none")},m(h,y){B(h,t,y),K(a,t,null),g(t,n),K(r,t,null),g(t,i),K(l,t,null),g(t,o),g(t,m),K(s,m,null),g(m,d),g(m,c),g(c,f),g(t,p),g(t,$),K(b,$,null),g($,C),g($,I),g(I,S),k=!0},p(h,y){const T={};y&2&&(T.controller=h[1].get("name")),a.$set(T);const D={};y&2&&(D.controller=h[1].get("admin").get("email")),r.$set(D);const A={};y&2&&(A.controller=h[1].get("region")),l.$set(A);const _={};y&2&&(_.controller=h[1].get("tfConnect")),s.$set(_);const u={};y&2&&(u.controller=h[1].get("certified")),b.$set(u),y&1&&J(t,"display",h[0]?"initial":"none")},i(h){k||(v(a.$$.fragment,h),v(r.$$.fragment,h),v(l.$$.fragment,h),v(s.$$.fragment,h),v(b.$$.fragment,h),k=!0)},o(h){M(a.$$.fragment,h),M(r.$$.fragment,h),M(l.$$.fragment,h),M(s.$$.fragment,h),M(b.$$.fragment,h),k=!1},d(h){h&&F(t),H(a),H(r),H(l),H(s),H(b)}}}function Dt(e){let t,a,n=e[1]&&Pe(e);return{c(){n&&n.c(),t=_e(),this.c=Y},m(r,i){n&&n.m(r,i),B(r,t,i),a=!0},p(r,[i]){r[1]?n?(n.p(r,i),i&2&&v(n,1)):(n=Pe(r),n.c(),v(n,1),n.m(t.parentNode,t)):n&&(re(),M(n,1,1,()=>{n=null}),ae())},i(r){a||(v(n),a=!0)},o(r){M(n),a=!1},d(r){n&&n.d(r),r&&F(t)}}}const Ot=e=>({label:e,value:e});function Gt(e,t,a){const{Input:n,Select:r,CheckBox:i}=window.tfSvelteBulmaWc;let{show:l}=t,{mastodon:o}=t;return e.$$set=m=>{"show"in m&&a(0,l=m.show),"mastodon"in m&&a(1,o=m.mastodon)},[l,o,n,r,i]}class nt extends oe{constructor(t){super(),le(this,{target:this.shadowRoot,props:ue(this.attributes),customElement:!0},Gt,Dt,se,{show:0,mastodon:1},null),t&&(t.target&&B(t.target,this,t.anchor),t.props&&(this.$set(t.props),x()))}static get observedAttributes(){return["show","mastodon"]}get show(){return this.$$.ctx[0]}set show(t){this.$$set({show:t}),x()}get mastodon(){return this.$$.ctx[1]}set mastodon(t){this.$$set({mastodon:t}),x()}}customElements.define("tf-basic-tab",nt);var at=(e=>(e.Credentials="MASTODON_LOGIN_CREDENTIALS",e))(at||{});class he{static write(t,a){return window.sessionStorage.setItem(t,JSON.stringify(a))}static read(t){const a=window.sessionStorage.getItem(t);return a?JSON.parse(a):null}}Ae(he,"Keys",at);function Lt(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var rt=Lt,Ft=typeof ve=="object"&&ve&&ve.Object===Object&&ve,jt=Ft,Kt=jt,Ht=typeof self=="object"&&self&&self.Object===Object&&self,Ut=Kt||Ht||Function("return this")(),it=Ut,Vt=it,qt=function(){return Vt.Date.now()},zt=qt,Wt=/\s/;function Jt(e){for(var t=e.length;t--&&Wt.test(e.charAt(t)););return t}var Yt=Jt,Qt=Yt,Xt=/^\s+/;function Zt(e){return e&&e.slice(0,Qt(e)+1).replace(Xt,"")}var xt=Zt,en=it,tn=en.Symbol,ot=tn,Ee=ot,lt=Object.prototype,nn=lt.hasOwnProperty,an=lt.toString,pe=Ee?Ee.toStringTag:void 0;function rn(e){var t=nn.call(e,pe),a=e[pe];try{e[pe]=void 0;var n=!0}catch{}var r=an.call(e);return n&&(t?e[pe]=a:delete e[pe]),r}var on=rn,ln=Object.prototype,sn=ln.toString;function un(e){return sn.call(e)}var fn=un,Be=ot,dn=on,cn=fn,mn="[object Null]",gn="[object Undefined]",Re=Be?Be.toStringTag:void 0;function pn(e){return e==null?e===void 0?gn:mn:Re&&Re in Object(e)?dn(e):cn(e)}var bn=pn;function hn(e){return e!=null&&typeof e=="object"}var _n=hn,wn=bn,vn=_n,yn="[object Symbol]";function Sn(e){return typeof e=="symbol"||vn(e)&&wn(e)==yn}var kn=Sn,$n=xt,De=rt,Cn=kn,Oe=0/0,Tn=/^[-+]0x[0-9a-f]+$/i,In=/^0b[01]+$/i,Mn=/^0o[0-7]+$/i,An=parseInt;function Nn(e){if(typeof e=="number")return e;if(Cn(e))return Oe;if(De(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=De(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=$n(e);var a=In.test(e);return a||Mn.test(e)?An(e.slice(2),a?2:8):Tn.test(e)?Oe:+e}var Pn=Nn,En=rt,$e=zt,Ge=Pn,Bn="Expected a function",Rn=Math.max,Dn=Math.min;function On(e,t,a){var n,r,i,l,o,m,s=0,d=!1,c=!1,f=!0;if(typeof e!="function")throw new TypeError(Bn);t=Ge(t)||0,En(a)&&(d=!!a.leading,c="maxWait"in a,i=c?Rn(Ge(a.maxWait)||0,t):i,f="trailing"in a?!!a.trailing:f);function p(T){var D=n,A=r;return n=r=void 0,s=T,l=e.apply(A,D),l}function $(T){return s=T,o=setTimeout(I,t),d?p(T):l}function b(T){var D=T-m,A=T-s,_=t-D;return c?Dn(_,i-A):_}function C(T){var D=T-m,A=T-s;return m===void 0||D>=t||D<0||c&&A>=i}function I(){var T=$e();if(C(T))return S(T);o=setTimeout(I,b(T))}function S(T){return o=void 0,f&&n?p(T):(n=r=void 0,l)}function k(){o!==void 0&&clearTimeout(o),s=0,n=m=r=o=void 0}function h(){return o===void 0?l:S($e())}function y(){var T=$e(),D=C(T);if(n=arguments,r=this,m=T,D){if(o===void 0)return $(m);if(c)return clearTimeout(o),o=setTimeout(I,t),p(m)}return o===void 0&&(o=setTimeout(I,t)),l}return y.cancel=k,y.flush=h,y}var st=On;function Le(e){let t,a,n,r;return t=new e[6]({props:{label:"Select farm id",options:[{label:"All",value:null},...e[3].map(Fe)],controller:e[8],loading:!e[5],disabled:!e[5]}}),n=new e[6]({props:{label:"Select Node ID",placeholder:"Select Node ID to deploy",validation:!e[4]&&!e[1].pending,loading:e[4]||e[1].pending,disabled:e[4]||e[1].pending,controller:e[7],options:e[2].map(je),hint:e[1].pending?"Checking node status (Up/Down)...":void 0}}),{c(){j(t.$$.fragment),a=E(),j(n.$$.fragment)},m(i,l){K(t,i,l),B(i,a,l),K(n,i,l),r=!0},p(i,l){const o={};l&8&&(o.options=[{label:"All",value:null},...i[3].map(Fe)]),l&32&&(o.loading=!i[5]),l&32&&(o.disabled=!i[5]),t.$set(o);const m={};l&18&&(m.validation=!i[4]&&!i[1].pending),l&18&&(m.loading=i[4]||i[1].pending),l&18&&(m.disabled=i[4]||i[1].pending),l&4&&(m.options=i[2].map(je)),l&2&&(m.hint=i[1].pending?"Checking node status (Up/Down)...":void 0),n.$set(m)},i(i){r||(v(t.$$.fragment,i),v(n.$$.fragment,i),r=!0)},o(i){M(t.$$.fragment,i),M(n.$$.fragment,i),r=!1},d(i){H(t,i),i&&F(a),H(n,i)}}}function Gn(e){let t,a,n=e[0]&&Le(e);return{c(){n&&n.c(),t=_e(),this.c=Y},m(r,i){n&&n.m(r,i),B(r,t,i),a=!0},p(r,[i]){r[0]?n?(n.p(r,i),i&1&&v(n,1)):(n=Le(r),n.c(),v(n,1),n.m(t.parentNode,t)):n&&(re(),M(n,1,1,()=>{n=null}),ae())},i(r){a||(v(n),a=!0)},o(r){M(n),a=!1},d(r){n&&n.d(r),r&&F(t)}}}const Fe=e=>({label:`${e.name}(${e.farmID})`,value:e.farmID}),je=e=>({label:`Node ID(${e.nodeId})`,value:e.nodeId});function Ln(e,t,a){let n,r;const{Select:i}=window.tfSvelteBulmaWc,{fb:l,FormGroup:o,validators:m}=window.tfSvelteRxForms,{default:s}=window.tfgridGql;let{mastodon:d}=t;const c=l.control(null,[Ne,m.required("Node ID is required.")],[St]);Se(e,c,y=>a(9,r=y));const f=l.control(null,[Ne]);let p=[],$=[];const b=st(async y=>{a(2,p=[]),a(4,I=!0),y.setDisabled(!0);const T=c.value;c.setValue(null);const D=y.value;if(delete D.region,D.mru/=1024,a(2,p=await kt(d.value.mnemonics,D)),f.value&&(a(2,p=p.filter(_=>_.farmId===f.value)),p.length===0)){const _=`No nodes satisfy the requirement with farm(${f.value}) were found.`;c.setValue(null,{error:_}),f.getValue().error!==_&&f.setValue(f.value,{error:_})}if(y.get("certified").value&&(a(2,p=p.filter(_=>_.certificationType==="Certified")),p.length===0)){const _="No certified nodes were found.";c.setValue(null,{error:_}),y.get("certified").getValue().error!==_&&y.get("certified").setValue(!0,{error:_})}const A=y.get("region").value;if(A!==null){const _=tt[A];if(a(2,p=p.filter(u=>_==null?void 0:_.includes(u.location.country))),p.length===0){const u=`No nodes were found in '${A}' region.`;c.setValue(null,{error:u}),y.get("region").getValue().error!==u&&y.get("region").setValue(A,{error:u})}}p.some(_=>_.nodeId===T)?c.setValue(T):p.length>0&&c.setValue(p[0].nodeId),c.markAsTouched(),c.markAsDirty(),a(4,I=!1),y.setDisabled(!1)},1500);async function C(){const y=new s(window.config.network),T={updatedAt_gt:Date.now()-1*60*60*1e3},D=["nodeID_ASC"],{totalCount:A}=await y.nodesConnection({totalCount:!0},{where:T,orderBy:D});a(3,$=A===0?[]:await y.nodes({farmID:!0},{where:T,orderBy:D,limit:A}).then(_=>y.farms({name:!0,farmID:!0},{where:{farmID_in:Array.from(new Set(_.map(u=>u.farmID)))},orderBy:["farmID_ASC"]}))),a(5,S=!0),b(h)}let I=!1,S=!1,k,h;return Ie(()=>k==null?void 0:k()),we(async()=>{await C(),h=new o({cru:d.get("cpu"),mru:d.get("memory"),sru:d.get("disk"),publicIPs:d.get("ipv4"),region:d.get("region"),certified:d.get("certified"),farmId:f}),k=h.subscribe(()=>{S&&(a(4,I=!0),d.get("nodeId").setValue(null),b(h))})}),e.$$set=y=>{"mastodon"in y&&a(0,d=y.mastodon)},e.$$.update=()=>{e.$$.dirty&512&&a(1,n=r),e.$$.dirty&3&&d&&n.valid&&(d.get("nodeId").setValue(n.value),d.get("nodeId").markAsDirty())},[d,n,p,$,I,S,i,c,f,r]}class ut extends oe{constructor(t){super(),le(this,{target:this.shadowRoot,props:ue(this.attributes),customElement:!0},Ln,Gn,se,{mastodon:0},null),t&&(t.target&&B(t.target,this,t.anchor),t.props&&(this.$set(t.props),x()))}static get observedAttributes(){return["mastodon"]}get mastodon(){return this.$$.ctx[0]}set mastodon(t){this.$$set({mastodon:t}),x()}}customElements.define("tf-select-node-id",ut);function Ke(e){let t,a;return t=new e[2]({props:{label:"Select Gateway Node",placeholder:"Please select a gateway node",controller:e[0].get("gateway"),options:e[1].map(He)}}),{c(){j(t.$$.fragment)},m(n,r){K(t,n,r),a=!0},p(n,r){const i={};r&1&&(i.controller=n[0].get("gateway")),r&2&&(i.options=n[1].map(He)),t.$set(i)},i(n){a||(v(t.$$.fragment,n),a=!0)},o(n){M(t.$$.fragment,n),a=!1},d(n){H(t,n)}}}function Fn(e){let t,a,n=e[0]&&Ke(e);return{c(){n&&n.c(),t=_e(),this.c=Y},m(r,i){n&&n.m(r,i),B(r,t,i),a=!0},p(r,[i]){r[0]?n?(n.p(r,i),i&1&&v(n,1)):(n=Ke(r),n.c(),v(n,1),n.m(t.parentNode,t)):n&&(re(),M(n,1,1,()=>{n=null}),ae())},i(r){a||(v(n),a=!0)},o(r){M(n),a=!1},d(r){n&&n.d(r),r&&F(t)}}}const He=([e,t])=>({label:e,value:t});function jn(e,t,a){let n,r=Y,i=()=>(r(),r=Me(o,s=>a(3,n=s)),o);e.$$.on_destroy.push(()=>r());const{Select:l}=window.tfSvelteBulmaWc;let{mastodon:o}=t;i();let m=[];return we(async()=>{const s=await $t(o.value.mnemonics);a(1,m=Object.keys(s).map(d=>[s[d].domain,d+":"+s[d].domain])),m.length&&o.get("gateway").setValue(m[0][1])}),e.$$set=s=>{"mastodon"in s&&i(a(0,o=s.mastodon))},e.$$.update=()=>{e.$$.dirty&8},[o,m,l,n]}class ft extends oe{constructor(t){super(),le(this,{target:this.shadowRoot,props:ue(this.attributes),customElement:!0},jn,Fn,se,{mastodon:0},null),t&&(t.target&&B(t.target,this,t.anchor),t.props&&(this.$set(t.props),x()))}static get observedAttributes(){return["mastodon"]}get mastodon(){return this.$$.ctx[0]}set mastodon(t){this.$$set({mastodon:t}),x()}}customElements.define("tf-select-gateway",ft);function Ue(e){let t,a,n,r,i,l,o,m,s,d,c,f,p,$,b,C,I,S,k,h,y,T,D,A;a=new e[3]({props:{label:"CPU (vCores)",placeholder:"CPU in vCores",type:"number",controller:e[1].get("cpu")}}),r=new e[3]({props:{label:"Memory (MB)",placeholder:"Memory in MB",type:"number",controller:e[1].get("memory")}}),l=new e[3]({props:{label:"Disk (GB)",placeholder:"Disk in GB",type:"number",controller:e[1].get("disk")}}),m=new e[4]({props:{label:"Planetary Network",controller:e[1].get("planetary")}}),d=new e[4]({props:{label:"Public IPv4",controller:e[1].get("ipv4")}}),f=new ft({props:{mastodon:e[1]}}),$=new ut({props:{mastodon:e[1]}}),C=new e[3]({props:{label:"Admin Username",placeholder:"Admin Username",controller:e[1].get("admin").get("username")}}),S=new e[3]({props:{label:"Admin Password",placeholder:"Admin Password",type:"password",controller:e[1].get("admin").get("password")}}),T=new e[4]({props:{label:"<strong>SMTP Server</strong>",controller:e[1].get("smtp").get("enable")}});let _=e[2]&&Ve(e);return{c(){t=w("section"),j(a.$$.fragment),n=E(),j(r.$$.fragment),i=E(),j(l.$$.fragment),o=E(),j(m.$$.fragment),s=E(),j(d.$$.fragment),c=E(),j(f.$$.fragment),p=E(),j($.$$.fragment),b=E(),j(C.$$.fragment),I=E(),j(S.$$.fragment),k=E(),h=w("div"),y=w("b-tooltip"),j(T.$$.fragment),D=E(),_&&_.c(),Z(y,"flow","left"),Z(y,"tooltip","Mastodon does not require an SMTP server. If you want to use an SMTP server, you can configure it."),z(h,"class","is-flex is-justify-content-right"),J(t,"display",e[0]?"initial":"none")},m(u,N){B(u,t,N),K(a,t,null),g(t,n),K(r,t,null),g(t,i),K(l,t,null),g(t,o),K(m,t,null),g(t,s),K(d,t,null),g(t,c),K(f,t,null),g(t,p),K($,t,null),g(t,b),K(C,t,null),g(t,I),K(S,t,null),g(t,k),g(t,h),g(h,y),K(T,y,null),g(t,D),_&&_.m(t,null),A=!0},p(u,N){const W={};N&2&&(W.controller=u[1].get("cpu")),a.$set(W);const Q={};N&2&&(Q.controller=u[1].get("memory")),r.$set(Q);const ie={};N&2&&(ie.controller=u[1].get("disk")),l.$set(ie);const G={};N&2&&(G.controller=u[1].get("planetary")),m.$set(G);const te={};N&2&&(te.controller=u[1].get("ipv4")),d.$set(te);const R={};N&2&&(R.mastodon=u[1]),f.$set(R);const ee={};N&2&&(ee.mastodon=u[1]),$.$set(ee);const P={};N&2&&(P.controller=u[1].get("admin").get("username")),C.$set(P);const U={};N&2&&(U.controller=u[1].get("admin").get("password")),S.$set(U);const O={};N&2&&(O.controller=u[1].get("smtp").get("enable")),T.$set(O),u[2]?_?(_.p(u,N),N&4&&v(_,1)):(_=Ve(u),_.c(),v(_,1),_.m(t,null)):_&&(re(),M(_,1,1,()=>{_=null}),ae()),N&1&&J(t,"display",u[0]?"initial":"none")},i(u){A||(v(a.$$.fragment,u),v(r.$$.fragment,u),v(l.$$.fragment,u),v(m.$$.fragment,u),v(d.$$.fragment,u),v(f.$$.fragment,u),v($.$$.fragment,u),v(C.$$.fragment,u),v(S.$$.fragment,u),v(T.$$.fragment,u),v(_),A=!0)},o(u){M(a.$$.fragment,u),M(r.$$.fragment,u),M(l.$$.fragment,u),M(m.$$.fragment,u),M(d.$$.fragment,u),M(f.$$.fragment,u),M($.$$.fragment,u),M(C.$$.fragment,u),M(S.$$.fragment,u),M(T.$$.fragment,u),M(_),A=!1},d(u){u&&F(t),H(a),H(r),H(l),H(m),H(d),H(f),H($),H(C),H(S),H(T),_&&_.d()}}}function Ve(e){let t,a,n,r,i,l,o,m;return t=new e[3]({props:{label:"SMTP Email",placeholder:"SMTP Email",controller:e[1].get("smtp").get("email")}}),n=new e[3]({props:{label:"SMTP Password",placeholder:"SMTP Password",type:"password",controller:e[1].get("smtp").get("password")}}),i=new e[3]({props:{label:"SMTP Server",placeholder:"SMTP Server",controller:e[1].get("smtp").get("server")}}),o=new e[3]({props:{label:"SMTP Port",placeholder:"SMTP Port",type:"number",controller:e[1].get("smtp").get("port")}}),{c(){j(t.$$.fragment),a=E(),j(n.$$.fragment),r=E(),j(i.$$.fragment),l=E(),j(o.$$.fragment)},m(s,d){K(t,s,d),B(s,a,d),K(n,s,d),B(s,r,d),K(i,s,d),B(s,l,d),K(o,s,d),m=!0},p(s,d){const c={};d&2&&(c.controller=s[1].get("smtp").get("email")),t.$set(c);const f={};d&2&&(f.controller=s[1].get("smtp").get("password")),n.$set(f);const p={};d&2&&(p.controller=s[1].get("smtp").get("server")),i.$set(p);const $={};d&2&&($.controller=s[1].get("smtp").get("port")),o.$set($)},i(s){m||(v(t.$$.fragment,s),v(n.$$.fragment,s),v(i.$$.fragment,s),v(o.$$.fragment,s),m=!0)},o(s){M(t.$$.fragment,s),M(n.$$.fragment,s),M(i.$$.fragment,s),M(o.$$.fragment,s),m=!1},d(s){H(t,s),s&&F(a),H(n,s),s&&F(r),H(i,s),s&&F(l),H(o,s)}}}function Kn(e){let t,a,n=e[1]&&Ue(e);return{c(){n&&n.c(),t=_e(),this.c=Y},m(r,i){n&&n.m(r,i),B(r,t,i),a=!0},p(r,[i]){r[1]?n?(n.p(r,i),i&2&&v(n,1)):(n=Ue(r),n.c(),v(n,1),n.m(t.parentNode,t)):n&&(re(),M(n,1,1,()=>{n=null}),ae())},i(r){a||(v(n),a=!0)},o(r){M(n),a=!1},d(r){n&&n.d(r),r&&F(t)}}}function Hn(e,t,a){let n,r,i,l=Y,o=()=>(l(),l=Me(c,p=>a(6,i=p)),c);e.$$.on_destroy.push(()=>l());const{Input:m,CheckBox:s}=window.tfSvelteBulmaWc;let{show:d}=t,{mastodon:c}=t;o();let f;return Ie(()=>f==null?void 0:f()),we(function p(){c||requestAnimationFrame(p);let $;f=c.get("smtp").get("enable").subscribe(b=>{$!==b.value&&($=b.value,Ct(c,$))})}),e.$$set=p=>{"show"in p&&a(0,d=p.show),"mastodon"in p&&o(a(1,c=p.mastodon))},e.$$.update=()=>{e.$$.dirty&64&&a(5,n=i),e.$$.dirty&32&&a(2,r=n?n.value.smtp.value.enable.value:!1)},[d,c,r,m,s,n,i]}class dt extends oe{constructor(t){super(),le(this,{target:this.shadowRoot,props:ue(this.attributes),customElement:!0},Hn,Kn,se,{show:0,mastodon:1},null),t&&(t.target&&B(t.target,this,t.anchor),t.props&&(this.$set(t.props),x()))}static get observedAttributes(){return["show","mastodon"]}get show(){return this.$$.ctx[0]}set show(t){this.$$set({show:t}),x()}get mastodon(){return this.$$.ctx[1]}set mastodon(t){this.$$set({mastodon:t}),x()}}customElements.define("tf-advanced-tab",dt);function qe(e,t,a){const n=e.slice();return n[2]=t[a].src,n[7]=t[a].alt,n[8]=t[a].url,n[10]=a,n}function Un(e){let t,a,n,r,i,l,o,m=e[3],s=[];for(let d=0;d<m.length;d+=1)s[d]=ze(qe(e,m,d));return{c(){t=w("h4"),t.innerHTML='Scan the QRcode using <a target="_blank" href="https://library.threefold.me/info/threefold#/tokens/threefold__threefold_connect" rel="noreferrer">ThreeFold Connect</a> to fund your account',a=E(),n=w("div"),r=w("img"),l=E(),o=w("div");for(let d=0;d<s.length;d+=1)s[d].c();z(t,"class","has-text-centered has-text-weight-bold"),Ce(r.src,i=e[2])||z(r,"src",i),z(r,"alt","qrcode"),z(n,"class","is-flex is-justify-content-center"),z(o,"class","has-text-centered")},m(d,c){B(d,t,c),B(d,a,c),B(d,n,c),g(n,r),B(d,l,c),B(d,o,c);for(let f=0;f<s.length;f+=1)s[f].m(o,null)},p(d,c){if(c&4&&!Ce(r.src,i=d[2])&&z(r,"src",i),c&8){m=d[3];let f;for(f=0;f<m.length;f+=1){const p=qe(d,m,f);s[f]?s[f].p(p,c):(s[f]=ze(p),s[f].c(),s[f].m(o,null))}for(;f<s.length;f+=1)s[f].d(1);s.length=m.length}},d(d){d&&F(t),d&&F(a),d&&F(n),d&&F(l),d&&F(o),_t(s,d)}}}function Vn(e){let t;return{c(){t=w("p"),t.textContent="Please Pass some data"},m(a,n){B(a,t,n)},p:Y,d(a){a&&F(t)}}}function qn(e){let t;return{c(){t=w("p"),t.textContent="Loading..."},m(a,n){B(a,t,n)},p:Y,d(a){a&&F(t)}}}function ze(e){let t,a,n,r;function i(){return e[4](e[8])}return{c(){t=w("img"),Ce(t.src,a="mastodon-weblet/"+e[2])||z(t,"src",a),z(t,"width","150"),z(t,"alt",e[7]),q(t,"mr-2",e[10]===0),J(t,"cursor","pointer")},m(l,o){B(l,t,o),n||(r=de(t,"mousedown",i),n=!0)},p(l,o){e=l},d(l){l&&F(t),n=!1,r()}}}function zn(e){let t;function a(i,l){if(i[1])return qn;if(!i[0])return Vn;if(i[2])return Un}let n=a(e),r=n&&n(e);return{c(){t=w("div"),r&&r.c(),this.c=Y,z(t,"class","mt-5 is-block")},m(i,l){B(i,t,l),r&&r.m(t,null)},p(i,[l]){n===(n=a(i))&&r?r.p(i,l):(r&&r.d(1),r=n&&n(i),r&&(r.c(),r.m(t,null)))},i:Y,o:Y,d(i){i&&F(t),r&&r.d()}}}function Wn(e,t,a){const n=window.qrcode;let{data:r}=t,i=!1,l;async function o(){a(1,i=!0),a(2,l=await n.toDataURL(r,{width:250})),a(1,i=!1)}const m=[{src:"android.svg",alt:"play-store",url:"https://play.google.com/store/apps/details?id=org.jimber.threebotlogin&hl=en&gl=US"},{src:"ios.svg",alt:"app-store",url:"https://apps.apple.com/us/app/threefold-connect/id1459845885"}],s=d=>window.open(d,"_blank");return e.$$set=d=>{"data"in d&&a(0,r=d.data)},e.$$.update=()=>{e.$$.dirty&1&&r&&o()},[r,i,l,m,s]}class ct extends oe{constructor(t){super(),le(this,{target:this.shadowRoot,props:ue(this.attributes),customElement:!0},Wn,zn,se,{data:0},null),t&&(t.target&&B(t.target,this,t.anchor),t.props&&(this.$set(t.props),x()))}static get observedAttributes(){return["data"]}get data(){return this.$$.ctx[0]}set data(t){this.$$set({data:t}),x()}}customElements.define("tf-qrcode",ct);function We(e){let t,a,n,r;return{c(){t=w("b-notification"),a=w("b-icon"),n=E(),r=X(e[7]),Z(a,"icon","fa-sharp fa-solid fa-triangle-exclamation"),Z(t,"color","warning"),Z(t,"light",""),q(t,"my-2",!0)},m(i,l){B(i,t,l),g(t,a),g(t,n),g(t,r)},p(i,l){l[0]&128&&ge(r,i[7])},d(i){i&&F(t)}}}function Je(e){let t,a;return t=new ct({props:{data:"TFT:"+e[16]+"?message=twin_"+e[6]+"&sender=me&amount=100"}}),{c(){j(t.$$.fragment)},m(n,r){K(t,n,r),a=!0},p(n,r){const i={};r[0]&64&&(i.data="TFT:"+n[16]+"?message=twin_"+n[6]+"&sender=me&amount=100"),t.$set(i)},i(n){a||(v(t.$$.fragment,n),a=!0)},o(n){M(t.$$.fragment,n),a=!1},d(n){H(t,n)}}}function Jn(e){let t,a,n,r,i,l,o,m,s,d,c,f,p,$,b,C,I,S,k,h,y,T,D;r=new e[14]({props:{label:"Mnemonics",placeholder:"Mnemonics",sublabel:"Mnemonics are your private key. They are used to represent you on the ThreeFold Grid. You can paste existing mnemonics or click the 'Create Account' button to create an account and generate mnemonics.",type:"password",controller:L.get("mnemonics"),disabled:e[13]||e[12],validation:!(e[13]||e[12]),hint:e[4].pending?"Validating mnemonics...":e[1]==="Error"?e[7]:void 0,hintColor:e[4].pending?"info":e[1]==="Error"?"danger":void 0}});let A=e[1]==="Done"&&e[7]&&We(e),_=(e[4].valid||!e[4].valid&&e[4].error===Te)&&e[6]&&Je(e);return b=new e[14]({props:{label:"Public SSH Key",type:"textarea",placeholder:"Your public SSH Key",sublabel:"SSH Keys are used to authenticate you to the Mastodon instance for management purposes. If you don't have an SSH Key or are not familiar, we can generate one for you.",controller:L.get("sshKey"),loading:e[2]||e[10]||e[3],disabled:!e[4].valid||e[2]||e[10]||e[3],hint:e[9]||(e[2]||e[10]||e[3]?e[8]:void 0),validation:!(e[2]||e[10]||e[3]),hintColor:e[2]||e[10]||e[3]?"info":void 0}}),{c(){t=w("section"),a=w("div"),n=w("div"),j(r.$$.fragment),i=E(),l=w("button"),o=X("Create Account"),d=E(),A&&A.c(),c=E(),_&&_.c(),f=E(),p=w("div"),$=w("div"),j(b.$$.fragment),C=E(),I=w("button"),S=X("Generate SSH Key"),this.c=Y,J(n,"width","100%"),z(l,"type","button"),l.disabled=m=e[4].valid||e[13]||e[12],q(l,"ml-2",!0),J(l,"margin-top","78px"),z(a,"class","is-flex is-jutify-content-center"),J($,"width","100%"),z(I,"type","button"),I.disabled=k=!e[4].valid||e[2]||e[10]||e[3]||e[5].valid,q(I,"ml-2",!0),J(I,"margin-top","78px"),z(p,"class","is-flex is-jutify-content-center mb-2"),J(t,"display",e[0]?"initial":"none")},m(u,N){B(u,t,N),g(t,a),g(a,n),K(r,n,null),g(a,i),g(a,l),g(l,o),g(t,d),A&&A.m(t,null),g(t,c),_&&_.m(t,null),g(t,f),g(t,p),g(p,$),K(b,$,null),g(p,C),g(p,I),g(I,S),e[28](t),y=!0,T||(D=[ce(s=e[15].call(null,l,{color:"primary",size:"small",loading:e[13]||e[12]})),de(l,"click",e[17]),ce(h=e[15].call(null,I,{color:"primary",size:"small",loading:e[2]||e[10]||e[3]})),de(I,"click",e[18])],T=!0)},p(u,N){const W={};N[0]&12288&&(W.disabled=u[13]||u[12]),N[0]&12288&&(W.validation=!(u[13]||u[12])),N[0]&146&&(W.hint=u[4].pending?"Validating mnemonics...":u[1]==="Error"?u[7]:void 0),N[0]&18&&(W.hintColor=u[4].pending?"info":u[1]==="Error"?"danger":void 0),r.$set(W),(!y||N[0]&12304&&m!==(m=u[4].valid||u[13]||u[12]))&&(l.disabled=m),s&&me(s.update)&&N[0]&12288&&s.update.call(null,{color:"primary",size:"small",loading:u[13]||u[12]}),u[1]==="Done"&&u[7]?A?A.p(u,N):(A=We(u),A.c(),A.m(t,c)):A&&(A.d(1),A=null),(u[4].valid||!u[4].valid&&u[4].error===Te)&&u[6]?_?(_.p(u,N),N[0]&80&&v(_,1)):(_=Je(u),_.c(),v(_,1),_.m(t,f)):_&&(re(),M(_,1,1,()=>{_=null}),ae());const Q={};N[0]&1036&&(Q.loading=u[2]||u[10]||u[3]),N[0]&1052&&(Q.disabled=!u[4].valid||u[2]||u[10]||u[3]),N[0]&1804&&(Q.hint=u[9]||(u[2]||u[10]||u[3]?u[8]:void 0)),N[0]&1036&&(Q.validation=!(u[2]||u[10]||u[3])),N[0]&1036&&(Q.hintColor=u[2]||u[10]||u[3]?"info":void 0),b.$set(Q),(!y||N[0]&1084&&k!==(k=!u[4].valid||u[2]||u[10]||u[3]||u[5].valid))&&(I.disabled=k),h&&me(h.update)&&N[0]&1036&&h.update.call(null,{color:"primary",size:"small",loading:u[2]||u[10]||u[3]}),N[0]&1&&J(t,"display",u[0]?"initial":"none")},i(u){y||(v(r.$$.fragment,u),v(_),v(b.$$.fragment,u),y=!0)},o(u){M(r.$$.fragment,u),M(_),M(b.$$.fragment,u),y=!1},d(u){u&&F(t),H(r),A&&A.d(),_&&_.d(),H(b),e[28](null),T=!1,ke(D)}}}function Yn(e,t,a){let n,r,i,l,o,m,s;Se(e,L,P=>a(27,s=P));let{show:d}=t;const{Input:c,btn:f}=window.tfSvelteBulmaWc,{HTTPMessageBusClient:p}=window.tsRmbHttpClient,{generateKeyPair:$}=window.webSshKeygen;let b=!1,C=window.config.network==="main"?"GBNOTAYUMXVO5QDYWYO2SOCOYIJ3XFIP65GKOQN7H65ZZSO6BK4SLWSC":window.config.network==="test"?"GA2CWNBUHX7NZ3B5GR4I23FMU7VY5RPA77IUJTIXTTTGKYSKDSV6LUA4":"GDHJP6TF3UXYXTNEZ2P36J5FH7W4BJJQ4AYYAXC66I2Q2AH5B6O6BCFG",I,S,k="None",h;async function y(){try{a(1,k="Creating");const{GridClient:P}=window.grid3_client,U=new p(0,"","",""),O=new P(window.config.network,"","test",U);O._connect();const V=await O.tfchain.createAccount("::1");L.get("mnemonics").setValue(V.mnemonic),await L.get("mnemonics").validate(),a(7,h="Please make sure to store your mnemonics somewhere safe to be able to access your deployments later on. There is no way for neither you nor ThreeFold nor anybody else to recover lost mnemonics."),a(1,k="Done")}catch(P){a(1,k="Error"),a(7,h=P)}}let T,D=!1,A,_,u=!1,N=!1,W,Q=!1;async function ie(){a(10,Q=!0),a(8,T="Generating Your SSH Key...");const P=await $({alg:"RSASSA-PKCS1-v1_5",hash:"SHA-256",name:"Threefold",size:4096});try{await(await be(n.value.mnemonics.value)).kvstore.set({key:"metadata",value:JSON.stringify({sshkey:P.publicKey})})}catch(V){a(9,W=V.message)}L.get("sshKey").setValue(P.publicKey),await L.get("sshKey").validate();const U=`data:text/raw;charset=utf-8,${encodeURIComponent(P.privateKey)}`,O=document.createElement("a");O.download="id_rsa",O.href=U,document.body.appendChild(O),O.click(),O.remove(),a(10,Q=!1)}let G;window.onresize=te,we(te),Ie(()=>{window.onresize=null});function te(){for(const P of G.children){const U=P.querySelector("button"),O=P.querySelector("input")||P.querySelector("textarea");try{const V=O.getBoundingClientRect().top-P.getBoundingClientRect().top;U&&O&&(U.style.marginTop=`${V}px`)}catch{requestAnimationFrame(te)}}}let R=!1;function ee(P){et[P?"unshift":"push"](()=>{G=P,a(11,G)})}return e.$$set=P=>{"show"in P&&a(0,d=P.show)},e.$$.update=()=>{if(e.$$.dirty[0]&134217728&&a(26,n=s),e.$$.dirty[0]&67633152&&L&&(b?he.write(he.Keys.Credentials,L.value.mnemonics):requestAnimationFrame(()=>{a(19,b=!0);const P=he.read(he.Keys.Credentials);P&&L.get("mnemonics").setValue(P)})),e.$$.dirty[0]&67108864&&a(4,r=n==null?void 0:n.value.mnemonics),e.$$.dirty[0]&16&&a(25,m=r?r.valid||!r.valid&&r.error===Te:!1),e.$$.dirty[0]&101711888&&m&&S!==r.value&&(a(20,S=r.value),be(n.value.mnemonics.value).then(P=>P.twins.get_my_twin_id()).then(P=>a(6,I=P))),e.$$.dirty[0]&67108864&&a(5,i=n==null?void 0:n.value.sshKey),e.$$.dirty[0]&10485812&&(r==null?void 0:r.valid)&&!(i!=null&&i.valid)&&!D&&!u){a(23,u=!0),a(2,D=!0),a(8,T="Reading Your SSH Key...");const P="metadata";be(r.value).then(async U=>{const O=await U.kvstore.get({key:P});O!==""&&requestAnimationFrame(()=>{a(21,A=JSON.parse(O).sshkey),a(22,_=r.value),L.get("sshKey").setValue(A)})}).finally(()=>a(2,D=!1))}e.$$.dirty[0]&6291512&&(r==null?void 0:r.valid)&&(i==null?void 0:i.valid)&&((i==null?void 0:i.value)!==A||(r==null?void 0:r.value)!==_)&&!N&&(a(21,A=i.value),a(22,_=r.value),a(3,N=!0),a(8,T="Storing Your SSH Key..."),be(r.value).then(P=>P.kvstore.set({key:"metadata",value:JSON.stringify({sshkey:A})})).finally(()=>a(3,N=!1))),e.$$.dirty[0]&16&&a(13,l=r==null?void 0:r.pending),e.$$.dirty[0]&2&&a(12,o=k==="Creating"),e.$$.dirty[0]&16777232&&(!r.valid&&R?(a(24,R=!1),L.get("sshKey").reset(),a(23,u=!1)):r.valid&&!R&&a(24,R=!0))},[d,k,D,N,r,i,I,h,T,W,Q,G,o,l,c,f,C,y,ie,b,S,A,_,u,R,m,n,s,ee]}class mt extends oe{constructor(t){super(),le(this,{target:this.shadowRoot,props:ue(this.attributes),customElement:!0},Yn,Jn,se,{show:0},null,[-1,-1]),t&&(t.target&&B(t.target,this,t.anchor),t.props&&(this.$set(t.props),x()))}static get observedAttributes(){return["show"]}get show(){return this.$$.ctx[0]}set show(t){this.$$set({show:t}),x()}}customElements.define("tf-credentials-tab",mt);function Qn(e){let t;return{c(){t=w("p"),t.textContent="Couldn't Load balance."},m(a,n){B(a,t,n)},p:Y,d(a){a&&F(t)}}}function Xn(e){let t,a,n,r=e[1].free+"",i,l,o,m,s,d,c,f=e[1].locked+"",p,$;return{c(){t=w("p"),a=X("Balance: "),n=w("strong"),i=X(r),l=X(" TFT"),o=E(),m=w("p"),s=w("strong"),s.innerHTML=`<a href="https://library.threefold.me/info/manual/#/manual__tfchain_home?id=contract-locking" target="_blank" rel="noreferrer" class="is-underlined">Locked</a> 
      `,d=X(": "),c=w("strong"),p=X(f),$=X(" TFT"),z(t,"class","mb-1"),J(t,"white-space","nowrap"),J(m,"white-space","nowrap")},m(b,C){B(b,t,C),g(t,a),g(t,n),g(n,i),g(n,l),B(b,o,C),B(b,m,C),g(m,s),g(m,d),g(m,c),g(c,p),g(c,$)},p(b,C){C&2&&r!==(r=b[1].free+"")&&ge(i,r),C&2&&f!==(f=b[1].locked+"")&&ge(p,f)},d(b){b&&F(t),b&&F(o),b&&F(m)}}}function Zn(e){let t;return{c(){t=w("p"),t.innerHTML="<strog>Loading...</strog>"},m(a,n){B(a,t,n)},p:Y,d(a){a&&F(t)}}}function xn(e){let t,a,n,r,i,l,o,m;function s(f,p){return f[0]?Zn:f[1]?Xn:Qn}let d=s(e),c=d(e);return{c(){t=w("b-box"),c.c(),a=E(),n=w("div"),r=w("button"),i=w("b-icon"),i.textContent="Reload",this.c=Y,Z(i,"icon","fa-solid fa-rotate-right"),r.disabled=e[0],q(r,"py-0",!0),z(n,"class","is-flex"),J(n,"margin-top","auto"),q(t,"is-flex",!0),q(t,"is-flex-direction-column",!0),q(t,"mb-2",!0),J(t,"border","1px solid var(--main-purple)"),J(t,"background-color","transparent"),J(t,"box-shadow","none")},m(f,p){B(f,t,p),c.m(t,null),g(t,a),g(t,n),g(n,r),g(r,i),o||(m=[ce(l=e[2].call(null,r,{color:"primary",outlined:!0,fullwidth:!0,loading:e[0]})),de(r,"click",e[4])],o=!0)},p(f,[p]){d===(d=s(f))&&c?c.p(f,p):(c.d(1),c=d(f),c&&(c.c(),c.m(t,a))),p&1&&(r.disabled=f[0]),l&&me(l.update)&&p&1&&l.update.call(null,{color:"primary",outlined:!0,fullwidth:!0,loading:f[0]})},i:Y,o:Y,d(f){f&&F(t),c.d(),o=!1,ke(m)}}}function ea(e,t,a){let n,r;const{btn:i}=window.tfSvelteBulmaWc,l=L.get("mnemonics");Se(e,l,c=>a(7,r=c));let o=!1,m,s;async function d(){a(0,o=!0),Tt(n.value).then(({free:c,feeFrozen:f})=>{a(1,m={free:c.toFixed(2),locked:f.toFixed(2)})}).finally(()=>{a(0,o=!1)})}return e.$$.update=()=>{e.$$.dirty&128&&a(6,n=r),e.$$.dirty&96&&n.valid&&s!==n.value&&(a(5,s=n.value),d())},[o,m,i,l,d,s,n,r]}class gt extends oe{constructor(t){super(),le(this,{target:this.shadowRoot,props:ue(this.attributes),customElement:!0},ea,xn,se,{},null),t&&t.target&&B(t.target,this,t.anchor)}}customElements.define("tf-mastodon-balance",gt);function Ye(e){let t,a,n=e[1].value.mnemonics.valid&&Qe(e);return{c(){n&&n.c(),t=_e()},m(r,i){n&&n.m(r,i),B(r,t,i),a=!0},p(r,i){r[1].value.mnemonics.valid?n?(n.p(r,i),i&2&&v(n,1)):(n=Qe(r),n.c(),v(n,1),n.m(t.parentNode,t)):n&&(re(),M(n,1,1,()=>{n=null}),ae())},i(r){a||(v(n),a=!0)},o(r){M(n),a=!1},d(r){n&&n.d(r),r&&F(t)}}}function Qe(e){let t,a,n,r,i,l,o,m=(e[3]?"Calculating...":e[2]?e[2]:"Failed to calculate standard price")+"",s,d,c,f,p,$,b,C,I,S,k;return S=new gt({}),{c(){t=w("div"),a=w("div"),n=w("b-box"),r=w("div"),i=w("div"),l=X(`Based on your specifications and TFChain TFT balance, your
                deployment cost is `),o=w("strong"),s=X(m),d=X(`
                USD/Month.`),c=w("br"),f=E(),p=w("strong"),p.innerHTML=`<a href="https://library.threefold.me/info/threefold#/cloud/threefold__pricing?id=discount-levels" target="_blank" rel="noreferrer" class="has-text-white is-underlined">Learn how to unlock discounts</a> 
                `,$=X("."),b=E(),C=w("div"),I=E(),j(S.$$.fragment),J(i,"line-height","45px"),q(n,"has-text-white",!0),q(n,"mb-2",!0),q(n,"is-flex",!0),q(n,"is-align-items-center",!0),J(n,"width","100%"),J(n,"background-color","var(--main-purple)"),z(a,"class","is-flex"),J(a,"width","100%"),z(C,"class","is-hidden-touch"),J(C,"width","1.25rem"),z(t,"class","is-flex-desktop")},m(h,y){B(h,t,y),g(t,a),g(a,n),g(n,r),g(r,i),g(i,l),g(i,o),g(o,s),g(i,d),g(i,c),g(i,f),g(i,p),g(i,$),g(t,b),g(t,C),g(t,I),K(S,t,null),k=!0},p(h,y){(!k||y&12)&&m!==(m=(h[3]?"Calculating...":h[2]?h[2]:"Failed to calculate standard price")+"")&&ge(s,m)},i(h){k||(v(S.$$.fragment,h),k=!0)},o(h){M(S.$$.fragment,h),k=!1},d(h){h&&F(t),H(S)}}}function ta(e){let t,a,n=e[0]&&Ye(e);return{c(){t=w("div"),n&&n.c(),this.c=Y},m(r,i){B(r,t,i),n&&n.m(t,null),a=!0},p(r,[i]){r[0]?n?(n.p(r,i),i&1&&v(n,1)):(n=Ye(r),n.c(),v(n,1),n.m(t,null)):n&&(re(),M(n,1,1,()=>{n=null}),ae())},i(r){a||(v(n),a=!0)},o(r){M(n),a=!1},d(r){r&&F(t),n&&n.d()}}}function na(e,t,a){let n,r,i=Y,l=()=>(i(),i=Me(o,f=>a(4,r=f)),o);e.$$.on_destroy.push(()=>i());let{mastodon:o}=t;l();let m,s=!0,d;const c=st(async function(){const{cpu:f,memory:p,disk:$,mnemonics:b}=n.value;if(!(f.valid&&p.valid&&$.valid))return;const C=`${f.value}:${p.value}:${$.value}`;if(d===C)return;a(3,s=!0),d=C;const I=await be(b.value);await I.balance.getMyBalance().then(S=>S.free.toFixed(2)),a(2,m=(await I.calculator.calculate({cru:f.value,sru:$.value+2,mru:p.value/1024,hru:0,balance:0})).sharedPrice),a(3,s=!1)},1e3);return e.$$set=f=>{"mastodon"in f&&l(a(0,o=f.mastodon))},e.$$.update=()=>{e.$$.dirty&16&&a(1,n=r),e.$$.dirty&2&&n&&n.value.mnemonics.valid&&c()},[o,n,m,s,r]}class pt extends oe{constructor(t){super(),le(this,{target:this.shadowRoot,props:ue(this.attributes),customElement:!0},na,ta,se,{mastodon:0},null),t&&(t.target&&B(t.target,this,t.anchor),t.props&&(this.$set(t.props),x()))}static get observedAttributes(){return["mastodon"]}get mastodon(){return this.$$.ctx[0]}set mastodon(t){this.$$set({mastodon:t}),x()}}customElements.define("tf-price-calculator",pt);function aa(e){let t,a,n,r,i,l,o,m,s,d,c,f,p,$=(e[5]||"Loading..")+"",b,C,I,S,k,h,y=e[2]?"Back":"Deploy",T,D,A,_,u,N,W,Q,ie;function G(O){e[25](O)}let te={tabs:[{id:"credentials",label:"Credentials",error:e[13]},...e[14]?[{id:"basic",label:"Basic",error:e[12]},{id:"advanced",label:"Advanced",error:e[11]}]:[]]};e[1]!==void 0&&(te.active=e[1]),n=new sa({props:te}),et.push(()=>wt(n,"active",G)),m=new mt({props:{show:e[1]==="credentials"}});let R=e[14]&&Xe(e);function ee(O,V){if(O[8])return oa;if(O[9])return ia}let P=ee(e),U=P&&P(e);return{c(){t=w("section"),a=w("section"),j(n.$$.fragment),i=E(),l=w("form"),o=w("section"),j(m.$$.fragment),s=E(),R&&R.c(),d=E(),c=w("section"),f=w("b-notification"),p=X("[+] "),b=X($),C=X("."),S=E(),k=w("div"),h=w("button"),T=X(y),u=E(),N=w("div"),U&&U.c(),q(a,"d-none",e[2]),J(a,"margin-top","35px"),q(o,"d-none",e[2]),Z(f,"color",I=e[3]?"danger":e[4]?"success":"info"),Z(f,"light",""),q(c,"d-none",!e[2]),z(h,"type",D=e[2]?"button":"submit"),h.disabled=A=e[13]||e[2]&&!e[3]&&!e[4]||e[6]||e[7],q(h,"py-0",!0),z(N,"class","ml-2"),J(N,"width","100%"),z(k,"class","is-flex mt-2 is-align-items-center"),z(l,"class","p-2"),q(t,"d-none",e[10])},m(O,V){B(O,t,V),g(t,a),K(n,a,null),g(t,i),g(t,l),g(l,o),K(m,o,null),g(o,s),R&&R.m(o,null),g(l,d),g(l,c),g(c,f),g(f,p),g(f,b),g(f,C),g(l,S),g(l,k),g(k,h),g(h,T),g(k,u),g(k,N),U&&U.m(N,null),W=!0,Q||(ie=[ce(_=e[16].call(null,h,{color:e[2]?"info":"primary",loading:e[2]&&!e[3]&&!e[4]})),de(h,"click",function(){me(e[2]?e[26]:void 0)&&(e[2]?e[26]:void 0).apply(this,arguments)}),de(l,"submit",vt(e[17]))],Q=!0)},p(O,V){e=O;const ne={};V&30720&&(ne.tabs=[{id:"credentials",label:"Credentials",error:e[13]},...e[14]?[{id:"basic",label:"Basic",error:e[12]},{id:"advanced",label:"Advanced",error:e[11]}]:[]]),!r&&V&2&&(r=!0,ne.active=e[1],yt(()=>r=!1)),n.$set(ne),(!W||V&4)&&q(a,"d-none",e[2]);const fe={};V&2&&(fe.show=e[1]==="credentials"),m.$set(fe),e[14]?R?(R.p(e,V),V&16384&&v(R,1)):(R=Xe(e),R.c(),v(R,1),R.m(o,null)):R&&(re(),M(R,1,1,()=>{R=null}),ae()),(!W||V&4)&&q(o,"d-none",e[2]),(!W||V&32)&&$!==($=(e[5]||"Loading..")+"")&&ge(b,$),(!W||V&24&&I!==(I=e[3]?"danger":e[4]?"success":"info"))&&Z(f,"color",I),(!W||V&4)&&q(c,"d-none",!e[2]),(!W||V&4)&&y!==(y=e[2]?"Back":"Deploy")&&ge(T,y),(!W||V&4&&D!==(D=e[2]?"button":"submit"))&&z(h,"type",D),(!W||V&8412&&A!==(A=e[13]||e[2]&&!e[3]&&!e[4]||e[6]||e[7]))&&(h.disabled=A),_&&me(_.update)&&V&28&&_.update.call(null,{color:e[2]?"info":"primary",loading:e[2]&&!e[3]&&!e[4]}),P!==(P=ee(e))&&(U&&U.d(1),U=P&&P(e),U&&(U.c(),U.m(N,null))),(!W||V&1024)&&q(t,"d-none",e[10])},i(O){W||(v(n.$$.fragment,O),v(m.$$.fragment,O),v(R),W=!0)},o(O){M(n.$$.fragment,O),M(m.$$.fragment,O),M(R),W=!1},d(O){O&&F(t),H(n),H(m),R&&R.d(),U&&U.d(),Q=!1,ke(ie)}}}function ra(e){let t,a,n,r,i,l,o,m,s,d,c,f,p,$;return t=new e[15]({props:{label:"Solution Code",placeholder:"Solution Code",controller:L.get("solutionCode"),validation:!e[0].value.solutionCode.pending,loading:e[0].value.solutionCode.pending}}),{c(){j(t.$$.fragment),a=E(),n=w("b-btns"),r=w("button"),i=X("Continue"),m=E(),s=w("button"),d=X("Don't have Code ?"),r.disabled=l=!e[0].value.solutionCode.valid,s.disabled=c=e[0].value.solutionCode.valid||e[0].value.solutionCode.pending,Z(n,"align","centered")},m(b,C){K(t,b,C),B(b,a,C),B(b,n,C),g(n,r),g(r,i),g(n,m),g(n,s),g(s,d),f=!0,p||($=[ce(o=e[16].call(null,r,{color:"primary",loading:e[0].value.solutionCode.pending})),de(r,"click",e[23]),ce(e[16].call(null,s,{color:"info"})),de(s,"click",e[24])],p=!0)},p(b,C){const I={};C&1&&(I.validation=!b[0].value.solutionCode.pending),C&1&&(I.loading=b[0].value.solutionCode.pending),t.$set(I),(!f||C&1&&l!==(l=!b[0].value.solutionCode.valid))&&(r.disabled=l),o&&me(o.update)&&C&1&&o.update.call(null,{color:"primary",loading:b[0].value.solutionCode.pending}),(!f||C&1&&c!==(c=b[0].value.solutionCode.valid||b[0].value.solutionCode.pending))&&(s.disabled=c)},i(b){f||(v(t.$$.fragment,b),f=!0)},o(b){M(t.$$.fragment,b),f=!1},d(b){H(t,b),b&&F(a),b&&F(n),p=!1,ke($)}}}function Xe(e){let t,a,n,r;return t=new nt({props:{mastodon:L,show:e[1]==="basic"}}),n=new dt({props:{mastodon:L,show:e[1]==="advanced"}}),{c(){j(t.$$.fragment),a=E(),j(n.$$.fragment)},m(i,l){K(t,i,l),B(i,a,l),K(n,i,l),r=!0},p(i,l){const o={};l&2&&(o.show=i[1]==="basic"),t.$set(o);const m={};l&2&&(m.show=i[1]==="advanced"),n.$set(m)},i(i){r||(v(t.$$.fragment,i),v(n.$$.fragment,i),r=!0)},o(i){M(t.$$.fragment,i),M(n.$$.fragment,i),r=!1},d(i){H(t,i),i&&F(a),H(n,i)}}}function ia(e){let t;return{c(){t=w("b-notification"),t.innerHTML=`<b-icon icon="fa-solid fa-circle-check"></b-icon> Your mastodon instance
                is up and running.`,Z(t,"color","success"),Z(t,"light","")},m(a,n){B(a,t,n)},d(a){a&&F(t)}}}function oa(e){let t;return{c(){t=w("b-notification"),t.innerHTML=`<b-icon icon="fas fa-spinner fa-pulse"></b-icon> Waiting for your mastodon
                instance to be up and running...`,Z(t,"color","warning"),Z(t,"light","")},m(a,n){B(a,t,n)},d(a){a&&F(t)}}}function Ze(e){let t,a;return t=new It({props:{data:e[6]}}),t.$on("close",e[27]),{c(){j(t.$$.fragment)},m(n,r){K(t,n,r),a=!0},p(n,r){const i={};r&64&&(i.data=n[6]),t.$set(i)},i(n){a||(v(t.$$.fragment,n),a=!0)},o(n){M(t.$$.fragment,n),a=!1},d(n){H(t,n)}}}function la(e){let t,a,n,r,i,l,o,m,s,d,c,f,p,$;o=new pt({props:{mastodon:L}});const b=[ra,aa],C=[];function I(k,h){return k[10]?0:1}c=I(e),f=C[c]=b[c](e);let S=e[6]&&e[7]&&Ze(e);return{c(){t=w("b-box"),a=w("b-content"),n=w("h2"),n.textContent="Deploy a Mastodon Instance",r=E(),i=w("p"),i.textContent=`Mastodon is free and open-source software for running self-hosted social
      networking services. It has microblogging features similar to the Twitter
      service, which are offered by a large number of independently run nodes,
      known as instances, each with its own code of conduct, terms of service,
      privacy options, and moderation policies.`,l=E(),j(o.$$.fragment),m=E(),s=w("hr"),d=E(),f.c(),p=E(),S&&S.c(),this.c=Y,z(n,"class","has-text-centered is-size-1 mt-0 "),q(t,"p-6",!0),q(t,"mt-3",!0),q(t,"is-size-5",!0),J(t,"font-family","'Lato', sans-serif")},m(k,h){B(k,t,h),g(t,a),g(a,n),g(a,r),g(a,i),g(a,l),K(o,a,null),g(a,m),g(a,s),g(t,d),C[c].m(t,null),g(t,p),S&&S.m(t,null),$=!0},p(k,[h]){let y=c;c=I(k),c===y?C[c].p(k,h):(re(),M(C[y],1,1,()=>{C[y]=null}),ae(),f=C[c],f?f.p(k,h):(f=C[c]=b[c](k),f.c()),v(f,1),f.m(t,p)),k[6]&&k[7]?S?(S.p(k,h),h&192&&v(S,1)):(S=Ze(k),S.c(),v(S,1),S.m(t,null)):S&&(re(),M(S,1,1,()=>{S=null}),ae())},i(k){$||(v(o.$$.fragment,k),v(f),v(S),$=!0)},o(k){M(o.$$.fragment,k),M(f),M(S),$=!1},d(k){k&&F(t),H(o),C[c].d(),S&&S.d()}}}const{Tabs:sa,btn:ha}=window.tfSvelteBulmaWc,{events:xe}=window.grid3_client;function ye(...e){for(const t of e)if(!t.valid&&(t.touched||t.dirty))return!0;return!1}function ua(e,t,a){let n,r,i,l,o,m,s,d,c;Se(e,L,G=>a(22,c=G));const{Input:f,btn:p}=window.tfSvelteBulmaWc;let{provider:$}=t,b="credentials",C=!1,I=!1,S=!1,k="",h,y=!1,T,D=!1;async function A(){var te;const{value:G}=L;try{await Mt(G.mnemonics,G.nodeId)}catch{await L.get("nodeId").validate(),L.get("certified").setValue(n.value.certified.value)}if(!L.valid){L.markAsDirty(),L.markAsTouched(),requestAnimationFrame(()=>{s?requestAnimationFrame(()=>{a(1,b="basic"),requestAnimationFrame(()=>{var R,ee;o.name.valid?o.admin.value.email.valid||(ee=L.get("admin").get("email").__input)==null||ee.focus():(R=L.get("name").__input)==null||R.focus()})}):d&&requestAnimationFrame(()=>{a(1,b="advanced"),requestAnimationFrame(()=>{var R,ee,P,U,O,V,ne,fe;o.cpu.valid?o.memory.valid?o.disk.valid?o.admin.value.username.valid?o.smtp.value.email.valid?o.smtp.value.password.valid?o.smtp.value.server.valid?o.smtp.value.port.valid||(fe=L.get("smtp").get("port").__input)==null||fe.focus():(ne=L.get("smtp").get("server").__input)==null||ne.focus():(V=L.get("smtp").get("password").__input)==null||V.focus():(O=L.get("smtp").get("email").__input)==null||O.focus():(U=L.get("admin").get("username").__input)==null||U.focus():(P=L.get("disk").__input)==null||P.focus():(ee=L.get("memory").__input)==null||ee.focus():(R=L.get("cpu").__input)==null||R.focus()})})});return}a(2,C=!0),(te=window.mastodonList)==null||te.setDisabled(!0),a(3,I=!1),a(4,S=!1),T&&(T(),a(8,T=void 0)),a(9,D=!1);try{xe.addListener("logs",ne=>a(5,k=ne));const R=await At(G.mnemonics,G.name),[ee,P]=G.gateway.split(":"),U=await Nt({...L.value,image:{flist:"https://hub.grid.tf/omda.3bot/threefolddev-getmastodon-latest.flist",entryPoint:"/sbin/zinit init"},rootFsSize:2,disks:[{name:Pt(15,"disk"),mountPoint:"/var/lib/docker",size:G.disk}],envs:[{key:"LOCAL_DOMAIN",value:`${R}.${P}`},{key:"SUPERUSER_USERNAME",value:G.admin.username},{key:"SUPERUSER_EMAIL",value:G.admin.email},{key:"SUPERUSER_PASSWORD",value:G.admin.password},{key:"SSH_KEY",value:G.sshKey},{key:"IS_TF_CONNECT",value:`${G.tfConnect}`},{key:"RELAYS_LINKS",value:JSON.stringify(Et())},...G.smtp.enable?[{key:"SMTP_SERVER",value:G.smtp.server},{key:"SMTP_LOGIN",value:G.smtp.email},{key:"SMTP_PASSWORD",value:G.smtp.password},{key:"SMTP_PORT",value:G.smtp.port.toString()}]:[]],solutionProviderID:G.solutionCode,metadata:JSON.stringify({type:"vm",name:L.value.name,projectName:"Mastodon"})});await Bt({domainName:R,mnemonics:G.mnemonics,planetaryIp:U[0].planetary,publicNodeId:+ee,solutionProviderID:G.solutionCode,metadata:JSON.stringify({type:"gateway",name:R,projectName:"Mastodon"})}),a(6,h=U),a(4,S=!0),a(5,k="Successfully deployed Mastodon instance.");const[O,V]=Rt(`https://${R}.${P}`);a(8,T=V),O.then(()=>{var ne,fe;(ne=window.mastodonList)==null||ne.reload(),(fe=window.mastodonList)==null||fe.setDisabled(!1),a(9,D=!0),a(8,T=void 0),a(7,y=!0)})}catch(R){a(5,k=R.message),a(3,I=!0)}xe.removeAllListeners("logs")}let _=!0;we(()=>{typeof $<"u"&&(a(10,_=!1),L.get("solutionCode").setValue(+$))});const u=()=>a(10,_=!1),N=()=>{L.get("solutionCode").setValue(1),a(10,_=!1)};function W(G){b=G,a(1,b)}const Q=G=>{G.preventDefault(),a(2,C=!1),a(4,S=!1),a(3,I=!1),a(9,D=!1),T&&(T(),a(8,T=void 0))},ie=()=>{a(6,h=void 0),a(7,y=!1)};return e.$$set=G=>{"provider"in G&&a(18,$=G.provider)},e.$$.update=()=>{e.$$.dirty&4194304&&a(0,n=c),e.$$.dirty&1&&a(21,r=n.value.mnemonics),e.$$.dirty&1&&a(20,i=n.value.sshKey),e.$$.dirty&3145728&&a(14,l=r.valid&&i.valid),e.$$.dirty&1&&a(19,o=n.value),e.$$.dirty&524288&&a(13,m=ye(o.mnemonics,o.sshKey)),e.$$.dirty&524288&&a(12,s=ye(o.name,o.admin.value.email,o.region,o.certified)),e.$$.dirty&524288&&a(11,d=ye(o.cpu,o.memory,o.disk,o.gateway,o.nodeId,o.admin.value.username,o.admin.value.password)||(o.smtp.value.enable.value?ye(o.smtp.value.email,o.smtp.value.password,o.smtp.value.port,o.smtp.value.server):!1))},[n,b,C,I,S,k,h,y,T,D,_,d,s,m,l,f,p,A,$,o,i,r,c,u,N,W,Q,ie]}class fa extends oe{constructor(t){super(),le(this,{target:this.shadowRoot,props:ue(this.attributes),customElement:!0},ua,la,se,{provider:18},null),t&&(t.target&&B(t.target,this,t.anchor),t.props&&(this.$set(t.props),x()))}static get observedAttributes(){return["provider"]}get provider(){return this.$$.ctx[18]}set provider(t){this.$$set({provider:t}),x()}}customElements.define("tf-mastodon",fa);export{fa as default};
